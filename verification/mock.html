<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mock Advanced Pods AJAX Filter</title>
    <!-- CSS Dependencies -->
    <link rel="stylesheet" href="assets/css/select2.min.css">
    <link rel="stylesheet" href="assets/css/nouislider.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <link rel="stylesheet" href="../advanced-pods-ajax-filter/assets/css/style.css">

    <style>
        body { margin: 0; background: #f4f4f4; padding-top: 50px; }
        .wrapper { max-width: 1200px; margin: 0 auto; }
        .description { text-align: center; margin-bottom: 50px; }
    </style>
</head>
<body>

    <div class="wrapper">
        <div class="description">
            <h1>Plugin Preview</h1>
            <p>Below is the mocked shortcode output.</p>
        </div>
    </div>

    <!-- MOCKED SHORTCODE OUTPUT -->
    <div id="apaf-container">

		<!-- Sticky Search Bar -->
		<div id="apaf-search-bar" class="apaf-bar">
			<form id="apaf-main-form">
				<div class="apaf-bar-inner">

					<!-- 1. Operation Toggle -->
					<div class="apaf-field apaf-toggle-wrapper">
						<div class="apaf-toggle">
							<input type="radio" name="finalidade" id="apaf-op-buy" value="comprar" checked>
							<label for="apaf-op-buy">Comprar</label>

							<input type="radio" name="finalidade" id="apaf-op-rent" value="alugar">
							<label for="apaf-op-rent">Alugar</label>

							<div class="apaf-toggle-bg"></div>
						</div>
					</div>

					<!-- 2. City -->
					<div class="apaf-field apaf-field-city">
						<select name="cidade" id="apaf-cidade" class="apaf-select2" data-placeholder="Cidade">
							<option value="">Cidade</option>
                            <option value="sao-paulo">São Paulo</option>
                            <option value="rio-de-janeiro">Rio de Janeiro</option>
						</select>
					</div>

					<!-- 3. Neighborhood (Dependent) -->
					<div class="apaf-field apaf-field-bairro">
						<select name="bairro[]" id="apaf-bairro" class="apaf-select2" multiple="multiple" data-placeholder="Bairro" disabled>
							<!-- Populated via AJAX -->
						</select>
					</div>

					<!-- 4. Property Type -->
					<div class="apaf-field apaf-field-type">
						<select name="tipo_imovel[]" id="apaf-tipo" class="apaf-select2" multiple="multiple" data-placeholder="Tipo de Imóvel">
                            <option value="apartamento">Apartamento</option>
                            <option value="casa">Casa</option>
                            <option value="cobertura">Cobertura</option>
						</select>
					</div>

					<!-- 5. Advanced Filters Button -->
					<div class="apaf-field apaf-field-advanced">
						<button type="button" id="apaf-btn-advanced" class="apaf-text-btn">
							Filtros Avançados <span class="fa fa-filter"></span>
						</button>
					</div>

					<!-- 6. Search Button -->
					<div class="apaf-field apaf-field-submit">
						<button type="button" id="apaf-btn-search" class="apaf-btn-black">BUSCAR</button>
					</div>
				</div>
			</form>
		</div>

		<!-- Advanced Modal -->
		<div id="apaf-modal" class="apaf-modal" aria-hidden="true">
			<div class="apaf-modal-overlay"></div>
			<div class="apaf-modal-content">
				<div class="apaf-modal-header">
					<h3>Filtros Avançados</h3>
					<button type="button" class="apaf-modal-close">&times;</button>
				</div>
				<div class="apaf-modal-body">

					<!-- 1. Zone -->
					<div class="apaf-modal-row">
						<label class="apaf-label">Localização / Zona</label>
						<select name="zona" id="apaf-zona" class="apaf-simple-select">
							<option value="">Todas</option>
                            <option value="urbana">Urbana</option>
                            <option value="rural">Rural</option>
						</select>
					</div>

					<!-- 2. Price Range -->
					<div class="apaf-modal-row">
						<label class="apaf-label">Faixa de Preço</label>
						<div id="apaf-price-slider"></div>
						<div class="apaf-price-inputs">
							<input type="text" id="apaf-price-display-min" readonly>
							<span class="separator">-</span>
							<input type="text" id="apaf-price-display-max" readonly>

							<!-- Hidden inputs for form submission -->
							<input type="hidden" name="min_price" id="apaf-input-min-price">
							<input type="hidden" name="max_price" id="apaf-input-max-price">
						</div>
					</div>

					<!-- 3. Details (Bedrooms, Bathrooms, Garages) -->
					<div class="apaf-modal-row apaf-details-row">
						<div class="apaf-detail-group">
							<label class="apaf-label">Quartos</label>
							<div class="apaf-circle-buttons" data-target="quartos">
								<button type="button" data-value="0">0</button>
								<button type="button" data-value="1">1</button>
								<button type="button" data-value="2">2</button>
								<button type="button" data-value="3">3</button>
								<button type="button" data-value="4+">4+</button>
								<input type="hidden" name="quartos" id="apaf-input-quartos">
							</div>
						</div>

						<div class="apaf-detail-group">
							<label class="apaf-label">Banheiros</label>
							<div class="apaf-circle-buttons" data-target="banheiros">
								<button type="button" data-value="0">0</button>
								<button type="button" data-value="1">1</button>
								<button type="button" data-value="2">2</button>
								<button type="button" data-value="3">3</button>
								<button type="button" data-value="4+">4+</button>
								<input type="hidden" name="banheiros" id="apaf-input-banheiros">
							</div>
						</div>

						<div class="apaf-detail-group">
							<label class="apaf-label">Vagas</label>
							<div class="apaf-circle-buttons" data-target="vagas">
								<button type="button" data-value="0">0</button>
								<button type="button" data-value="1">1</button>
								<button type="button" data-value="2">2</button>
								<button type="button" data-value="3">3</button>
								<button type="button" data-value="4+">4+</button>
								<input type="hidden" name="vagas" id="apaf-input-vagas">
							</div>
						</div>
					</div>

					<!-- 4. Financing -->
					<div class="apaf-modal-row">
						<label class="apaf-checkbox-label">
							<input type="checkbox" name="aceita_financiamento" id="apaf-financiamento" value="1">
							<span class="checkmark"></span>
							Aceita Financiamento?
						</label>
					</div>

				</div>
				<div class="apaf-modal-footer">
					<button type="button" id="apaf-btn-apply" class="apaf-btn-large">APLICAR FILTROS</button>
				</div>
			</div>
		</div>

		<!-- Results Container -->
		<div id="apaf-results-wrapper">
			<div id="apaf-results-loader" style="display:none;">
				<div class="spinner">Loading...</div>
			</div>
			<div id="apaf-results-container"></div>
		</div>

	</div>
    <!-- END MOCKED SHORTCODE OUTPUT -->

    <!-- JS Dependencies -->
    <script src="assets/js/jquery.min.js"></script>
    <script src="assets/js/select2.min.js"></script>
    <script src="assets/js/nouislider.min.js"></script>

    <!-- Mock Obj -->
    <script>
        var apaf_obj = {
            ajax_url: '/mock-ajax', // This won't work in real browser but good for static testing
            nonce: '123456'
        };

        // Mock AJAX for checking behavior locally without server
        $.ajax = function(params) {
            console.log("Mock AJAX call:", params);

            var action = null;
            if (Array.isArray(params.data)) {
                // Find action in array
                var actionItem = params.data.find(item => item.name === 'action');
                if (actionItem) action = actionItem.value;
            } else if (typeof params.data === 'object') {
                action = params.data.action;
            }

            if (action === 'apaf_get_bairros') {
                setTimeout(function() {
                     params.success({
                         success: true,
                         data: [
                             {id: 'centro', text: 'Centro'},
                             {id: 'jardins', text: 'Jardins'},
                             {id: 'pinheiros', text: 'Pinheiros'}
                         ]
                     });
                }, 100); // Reduced timeout
            } else if (action === 'apaf_filter_imoveis') {
                setTimeout(function() {
                    params.success({
                        success: true,
                        data: {
                            html: '<div class="apaf-results-grid"><div class="apaf-card"><div class="apaf-card-image" style="background:#ddd;"></div><div class="apaf-card-content"><h3 class="apaf-card-title">Imóvel Teste</h3><div class="apaf-card-price">R$ 500.000,00</div></div></div></div>'
                        }
                    });
                }, 100); // Reduced timeout
            } else {
                console.warn("Unknown mock action:", action);
            }
        };
    </script>

    <script src="../advanced-pods-ajax-filter/assets/js/script.js"></script>
</body>
</html>
